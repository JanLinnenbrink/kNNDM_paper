dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise(mean_value = mean(value),
sd_value = sd(value))
(k_pl <- ggplot(sim_diff, aes(x=k, group=k)) +
geom_line(aes(y=mean_value, group=distr), colour="navy") +
geom_point(aes(y=mean_value), shape=21, size=0.8, colour="navy") +
geom_errorbar(aes(ymax=mean_value+sd_value, ymin=mean_value-sd_value),
width=0.4, linewidth=0.2, colour="navy") +
geom_hline(yintercept = 0) +
scale_y_continuous("") +
scale_x_continuous(breaks=seq(2,20,6)) +
xlab("k") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = "None",
#axis.text.x = element_markdown(),
panel.grid.minor = element_blank()) +
facet_grid(rows=vars(group), cols=vars(distr),
scales="free_y", labeller=label_parsed))
ggsave("figures/fig7_diff_k_2.pdf", k_pl, height=6, width=8)
IQR(sim_diff$mean_value)
quantile(sim_diff$mean_value)
quantile(sim_diff$mean_value)[2]
quantile(sim_diff$mean_value)[4]
sim_diff <- data.frame(rmse_knndm = sim_res$RMSE_knndm - sim_res$RMSE_surf,
r2_knndm = sim_res$R2_knndm - sim_res$R2_surf,
mae_knndm = sim_res$MAE_knndm - sim_res$MAE_surf,
W_knndm = sim_res$W_knndmCV,
dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise(mean_value = median(value),
q25 = quantile(value)[2],
q75 = quantile(value[4]),
sd_value = sd(value))
quantile(sim_diff$mean_value)[4]
quantile(sim_diff$mean_value)[[2]]
sim_diff <- data.frame(rmse_knndm = sim_res$RMSE_knndm - sim_res$RMSE_surf,
r2_knndm = sim_res$R2_knndm - sim_res$R2_surf,
mae_knndm = sim_res$MAE_knndm - sim_res$MAE_surf,
W_knndm = sim_res$W_knndmCV,
dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise(median_value = median(value),
q25 = quantile(value)[[2]],
q75 = quantile(value[[4]]),
sd_value = sd(value))
sim_diff
sim_diff <- data.frame(rmse_knndm = sim_res$RMSE_knndm - sim_res$RMSE_surf,
r2_knndm = sim_res$R2_knndm - sim_res$R2_surf,
mae_knndm = sim_res$MAE_knndm - sim_res$MAE_surf,
W_knndm = sim_res$W_knndmCV,
dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise(median_value = median(value),
sd_value = sd(value))
sim_diff <- data.frame(rmse_knndm = sim_res$RMSE_knndm - sim_res$RMSE_surf,
r2_knndm = sim_res$R2_knndm - sim_res$R2_surf,
mae_knndm = sim_res$MAE_knndm - sim_res$MAE_surf,
W_knndm = sim_res$W_knndmCV,
dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise(mas_tibble_row(quantile(value)))
sim_diff <- data.frame(rmse_knndm = sim_res$RMSE_knndm - sim_res$RMSE_surf,
r2_knndm = sim_res$R2_knndm - sim_res$R2_surf,
mae_knndm = sim_res$MAE_knndm - sim_res$MAE_surf,
W_knndm = sim_res$W_knndmCV,
dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise(as_tibble_row(quantile(value)))
sim_diff <- data.frame(rmse_knndm = sim_res$RMSE_knndm - sim_res$RMSE_surf,
r2_knndm = sim_res$R2_knndm - sim_res$R2_surf,
mae_knndm = sim_res$MAE_knndm - sim_res$MAE_surf,
W_knndm = sim_res$W_knndmCV,
dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise(tidyr::as_tibble_row(quantile(value)))
sim_diff <- data.frame(rmse_knndm = sim_res$RMSE_knndm - sim_res$RMSE_surf,
r2_knndm = sim_res$R2_knndm - sim_res$R2_surf,
mae_knndm = sim_res$MAE_knndm - sim_res$MAE_surf,
W_knndm = sim_res$W_knndmCV,
dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise(tidyverse::as_tibble_row(quantile(value)))
sim_diff <- data.frame(rmse_knndm = sim_res$RMSE_knndm - sim_res$RMSE_surf,
r2_knndm = sim_res$R2_knndm - sim_res$R2_surf,
mae_knndm = sim_res$MAE_knndm - sim_res$MAE_surf,
W_knndm = sim_res$W_knndmCV,
dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise_at(vars(value),
list(min=min, Q1=~quantile(., probs = 0.25),
median=median, Q3=~quantile(., probs = 0.75),
max=max))
sim_diff
(k_pl <- ggplot(sim_diff, aes(x=k, group=k)) +
geom_line(aes(y=median_value, group=distr), colour="navy") +
geom_point(aes(y=median_value), shape=21, size=0.8, colour="navy") +
geom_errorbar(aes(ymax=Q1, ymin=Q3),
width=0.4, linewidth=0.2, colour="navy") +
geom_hline(yintercept = 0) +
scale_y_continuous("") +
scale_x_continuous(breaks=seq(2,20,6)) +
xlab("k") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = "None",
#axis.text.x = element_markdown(),
panel.grid.minor = element_blank()) +
facet_grid(rows=vars(group), cols=vars(distr),
scales="free_y", labeller=label_parsed))
(k_pl <- ggplot(sim_diff, aes(x=k, group=k)) +
geom_line(aes(y=median_value, group=distr), colour="navy") +
geom_point(aes(y=median_value), shape=21, size=0.8, colour="navy") +
geom_errorbar(aes(ymin=Q1, ymax=Q3),
width=0.4, linewidth=0.2, colour="navy") +
geom_hline(yintercept = 0) +
scale_y_continuous("") +
scale_x_continuous(breaks=seq(2,20,6)) +
xlab("k") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = "None",
#axis.text.x = element_markdown(),
panel.grid.minor = element_blank()) +
facet_grid(rows=vars(group), cols=vars(distr),
scales="free_y", labeller=label_parsed))
summarise(median_value = median(value),
q25 = quantile(value)[[2]],
q75 = quantile(value[[4]]),
sd_value = sd(value))
sim_diff <- data.frame(rmse_knndm = sim_res$RMSE_knndm - sim_res$RMSE_surf,
r2_knndm = sim_res$R2_knndm - sim_res$R2_surf,
mae_knndm = sim_res$MAE_knndm - sim_res$MAE_surf,
W_knndm = sim_res$W_knndmCV,
dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise_at(vars(value),
list(min=min, Q1=~quantile(., probs = 0.25),
median=median, Q3=~quantile(., probs = 0.75),
max=max))
(k_pl <- ggplot(sim_diff, aes(x=k, group=k)) +
geom_line(aes(y=median, group=distr), colour="navy") +
geom_point(aes(y=median), shape=21, size=0.8, colour="navy") +
geom_errorbar(aes(ymin=Q1, ymax=Q3),
width=0.4, linewidth=0.2, colour="navy") +
geom_hline(yintercept = 0) +
scale_y_continuous("") +
scale_x_continuous(breaks=seq(2,20,6)) +
xlab("k") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = "None",
#axis.text.x = element_markdown(),
panel.grid.minor = element_blank()) +
facet_grid(rows=vars(group), cols=vars(distr),
scales="free_y", labeller=label_parsed))
ggsave("figures/fig7_diff_k_2.pdf", k_pl, height=6, width=8)
k_pl
sim_diff <- data.frame(rmse_knndm = sim_res$RMSE_knndm - sim_res$RMSE_surf,
r2_knndm = sim_res$R2_knndm - sim_res$R2_surf,
mae_knndm = sim_res$MAE_knndm - sim_res$MAE_surf,
W_knndm = sim_res$W_knndmCV,
dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise(x = quantile(value, c(0.25, 0.5, 0.75)), q = c(0.25, 0.5, 0.75))
sim_diff <- data.frame(rmse_knndm = sim_res$RMSE_knndm - sim_res$RMSE_surf,
r2_knndm = sim_res$R2_knndm - sim_res$R2_surf,
mae_knndm = sim_res$MAE_knndm - sim_res$MAE_surf,
W_knndm = sim_res$W_knndmCV,
dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise(value = quantile(value, c(0.25, 0.5, 0.75)), q = c(0.25, 0.5, 0.75))
sim_diff
sim_diff <- data.frame(rmse_knndm = sim_res$RMSE_knndm - sim_res$RMSE_surf,
r2_knndm = sim_res$R2_knndm - sim_res$R2_surf,
mae_knndm = sim_res$MAE_knndm - sim_res$MAE_surf,
W_knndm = sim_res$W_knndmCV,
dsample = sim_res$dsample, k=sim_res$k) |>
pivot_longer(!c(dsample,k)) |>
mutate(distr = case_when(dsample == "sregular" ~ "Strongly~regular",
dsample == "wregular" ~ "Weakly~regular",
dsample == "random" ~ "Random",
dsample == "wclust" ~ "Weakly~clustered",
dsample == "sclust" ~ "Strongly~clustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Strongly~regular", "Weakly~regular", "Random",
"Weakly~clustered", "Strongly~clustered")),
CV_method = "kNNDM 10-fold",
group = case_when(startsWith(name, "rmse") ~ "CV-true~RMSE",
startsWith(name, "mae") ~ "CV-true~MAE",
startsWith(name, "r2") ~ "CV-true~R^2",
startsWith(name, "W_") ~ "W"),
group=fct_relevel(group, "CV-true~RMSE", "CV-true~R^2", "CV-true~MAE", "W")) |>
group_by(distr, k, group) |>
summarise_at(vars(value),
list(Q1=~quantile(., probs = 0.25),
median=median, Q3=~quantile(., probs = 0.75)))
sim_diff
library("ggplot2")
library("dplyr")
library("ggplot2")
library("dplyr")
library("forcats")
library("tidyr")
time_res <- bind_rows(read.csv("simulation1_virtualSpecies/results/time_res_sclust.csv"),
read.csv("simulation1_virtualSpecies/results/time_res_rand.csv")) |>
mutate(distr = case_when(dsample == "random" ~ "Random", dsample == "sclust" ~ "Strongly\nclustered"),
distr = as.factor(distr),
distr = fct_relevel(distr, c("Random", "Strongly\nclustered")))
names(time_res) <- c("dsample", "knndm_time_model", "nndm_time_model", "knndm_time_algorithm", "nndm_time_algorithm", "n_tpoints", "distr")
tm <- time_res |>
dplyr::select(-dsample) |>
mutate(knndm_total = knndm_time_algorithm + knndm_time_model,
nndm_total = nndm_time_algorithm + nndm_time_model) |>
group_by(n_tpoints, distr) |>
pivot_longer(!c(n_tpoints, distr)) |>
ungroup()
tm$what <- sub(pattern = ".*_", "", x = tm$name)
tm$type <- sub(pattern = "\\_.*", "", x = tm$name)
tp_ext <- ggplot(tm, aes(x=n_tpoints, y=value/3600, colour=type, group=what)) +
geom_point() +
facet_grid(distr~what) +
scale_colour_discrete(name="", labels=c("kNNDM 10-fold CV", "NNDM LOO CV")) +
scale_x_continuous(limits=c(0,4000), breaks=c(0,2000,4000)) +
scale_y_log10(labels = function(x) format(x, scientific = FALSE)) +
xlab("n training points") +
ylab("time [h]") +
theme_bw(base_size=15) +
theme(legend.position = "bottom")
tp_ext
tm |>
filter(what=="total") |>
select(-c("type", "what")) |>
pivot_wider(names_from=name, values_from=value) |>
mutate("time_diff" = (nndm_total-knndm_total)/nndm_total*100) |>
slice(which.min(time_diff), which.max(time_diff))
time_nndm_max <- tm |> filter(what=="total" & type=="nndm") |> slice(which.max(value))
time_nndm_min <- tm |> filter(what=="total" & type=="nndm") |> slice(which.min(value))
time_knndm_max <- tm |> filter(what=="total" & type=="knndm" & n_tpoints==time_nndm_max$n_tpoints & distr==time_nndm_max$distr)
time_knndm_min <- tm |> filter(what=="total" & type=="knndm" & n_tpoints==time_nndm_min$n_tpoints & distr==time_nndm_min$distr)
tm |>
dplyr::filter(what=="total") |>
dplyr::select(-c("type", "what")) |>
pivot_wider(names_from=name, values_from=value) |>
mutate("time_diff" = (nndm_total-knndm_total)/nndm_total*100) |>
slice(which.min(time_diff), which.max(time_diff))
tm |>
dplyr::filter(what=="total") |>
dplyr::select(-c("type", "what")) |>
pivot_wider(names_from=name, values_from=value) |>
mutate("time_diff" = nndm_total-knndm_total) |>
slice(which.min(time_diff), which.max(time_diff))
time_nndm_max <- tm |> filter(what=="total" & type=="nndm") |> slice(which.max(value))
time_nndm_max
tm |>
dplyr::filter(what=="total") |>
dplyr::select(-c("type", "what")) |>
pivot_wider(names_from=name, values_from=value) |>
mutate("time_diff" = nndm_total-knndm_total) |>
slice(which.min(time_diff), which.max(time_diff))
tm |>
dplyr::filter(what=="total") |>
dplyr::select(-c("type", "what")) |>
pivot_wider(names_from=name, values_from=value) |>
mutate("time_diff" = nndm_total-knndm_total) |>
slice(which.max(time_diff))
library("ggplot2")
library("sf")
library("CAST")
library("cowplot")
source("simulation1_virtualSpecies/code/figures_utils.R")
wgrid <- quiet(st_read(dsn="simulation1_virtualSpecies/data/species_vdata.gpkg", layer="landscape_grid"))
??\newpage
??qiuet
??quiet
wgrid <- quiet(st_read(dsn="simulation1_virtualSpecies/data/species_vdata.gpkg", layer="landscape_grid"))
AOI <- quiet(st_read(dsn="simulation1_virtualSpecies/data/species_vdata.gpkg", layer="sampling_polygon")) |>
st_transform(st_crs(wgrid))
```{r figure 3, fig.width=12,fig.height=6, message=FALSE}
library("ggplot2")
library("sf")
library("CAST")
library("cowplot")
source("simulation1_virtualSpecies/code/figures_utils.R")
wgrid <- quiet(st_read(dsn="simulation1_virtualSpecies/data/species_vdata.gpkg", layer="landscape_grid"))
AOI <- quiet(st_read(dsn="simulation1_virtualSpecies/data/species_vdata.gpkg", layer="sampling_polygon")) |>
st_transform(st_crs(wgrid))
set.seed(10)
library(ggplot2)
library(dplyr)
library(tidyr)
library(sf)
library(terra)
library(tidyterra)
library(dplyr)
library(tidyr)
library(sf)
library(terra)
library(tidyterra)
library(cowplot)
library(forcats)
infolder  <- "simulation2_AGB/data/"
smpl <- c("regular", "simpleRandom", "clusterMedium", "clusterStrong", "clusterGapped")
title_smpl <- c("regular", "random", "weakly clustered", "medium clustered", "strongly clustered")
loadRData <- function(fileName){
load(fileName)
get(ls()[ls() != "fileName"])
}
# load example points
pts_sf <- paste0(infolder, smpl, "/AGBdata001.Rdata") |>
lapply(function(x) loadRData(x))
pts_sf <- lapply(1:length(pts_sf), function(i) {
pts_sf[[i]] <- data.frame(x=pts_sf[[i]]$xcoord * 1000, y=pts_sf[[i]]$ycoord * 1000) |>
st_as_sf(coords=c("x", "y"), crs="epsg:3035")
pts_sf[[i]]$sampling <- smpl[[i]]
if(nrow(pts_sf[[i]]) < 5000) {
pts_sf[[i]][nrow(pts_sf[[i]]):5000, ] <- NA
}
pts_sf[[i]] |>
select(sampling)
})
pts_sf <- do.call(rbind, pts_sf) |>
mutate(sampling = case_when(sampling=="simpleRandom" ~ "random",
sampling=="regular" ~ "regular",
sampling=="clusterMedium" ~ "weakly clustered",
sampling=="clusterStrong" ~ "medium clustered",
sampling=="clusterGapped" ~ "strongly clustered"),
sampling = as.factor(sampling),
sampling = fct_relevel(sampling, c("regular", "random", "weakly clustered", "medium clustered", "strongly clustered")))
# load AOI
aoi <- st_read("simulation2_AGB/data/strata.shp") |>
st_union()
# load AOI
aoi <- quiet(st_read("simulation2_AGB/data/strata.shp")) |>
st_union()
