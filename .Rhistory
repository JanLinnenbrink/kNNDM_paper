dist_knndm
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(RMSE == .(round(err_knndm[[3]],2)))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(RMSE == .(round(err_knndm[[3]],2)) ~ "\n t")
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[3]],2)) ~ "\n t"))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[3]],2)),"\n t"))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
source("~/.active-rstudio-document", echo=TRUE)
err_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
R^2 == .(round(err_knndm[[2]],2)),
MAE == .(round(err_knndm[[3]],2))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
R^2 == .(round(err_knndm[[2]],2)),
MAE == .(round(err_knndm[[3]],2))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
atop(R^2 == .(round(err_knndm[[2]],2)),
MAE == .(round(err_knndm[[3]],2)))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0, size=6)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
R^2 == .(round(err_knndm[[2]],2),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0, size=6)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
atop(R^2 == .(round(err_knndm[[2]],2),
scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
atop(scriptscriptstyle(""),R^2 == .(round(err_knndm[[2]],2),
textstyle(MAE == .(round(err_knndm[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
atop(R^2 == .(round(err_knndm[[2]],2),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2))))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
atop(R^2 == .(round(err_knndm[[2]],2),
atop(scriptscriptstyle(""),MAE == .(round(err_knndm[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
atop(R^2 == .(round(err_knndm[[2]],2),
MAE == .(round(err_knndm[[3]],2))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
atop(R^2 == .(round(err_knndm[[2]],2)),
MAE == .(round(err_knndm[[3]],2))))))
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
atop(R^2 == .(round(err_knndm[[2]],2)),
MAE == .(round(err_knndm[[3]],2)))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
atop(R^2 == .(round(err_knndm[[2]],2)),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
atop(scriptscriptstyle(""),textstyle(R^2 == .(round(err_knndm[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
l <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
atop(textstyle(R^2 == .(round(err_knndm[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4,parse=F, label=l, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
lab_knndm <- bquote(atop(RMSE == .(round(err_knndm[[1]],2)),
atop(textstyle(R^2 == .(round(err_knndm[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4, label=lab_knndm, colour="black",hjust = -0.2, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
atop(atop(textstyle(RMSE == .(round(err_knndm[[1]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2))))))))
lab_knndm <- bquote(
atop(W = sla_kndm$W,
atop(atop(textstyle(RMSE == .(round(err_knndm[[1]],2)))),
atop(textstyle(R^2 == .(round(err_knndm[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2))))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
lab_knndm <- bquote(
atop(W = .(sla_kndm$W),
atop(atop(textstyle(RMSE == .(round(err_knndm[[1]],2)))),
atop(textstyle(R^2 == .(round(err_knndm[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2))))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
lab_knndm <- bquote(
atop(textstyle(W = .(sla_kndm$W)),
atop(textstyle(RMSE == .(round(err_knndm[[1]],2)))),
atop(textstyle(R^2 == .(round(err_knndm[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
lab_knndm <- bquote(
atop(textstyle(RMSE == .(round(err_knndm[[1]],2))),
atop(textstyle(R^2 == .(round(err_knndm[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
geom_segment(aes(x = 11.6^6, y = 0.6, xend = 9.45^6, yend = 0.7),
arrow = arrow(length = unit(0.3, "cm")), colour="black") +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_knndm
lab_rand <- bquote(
atop(textstyle(RMSE == .(round(err_rand[[1]],2))),
atop(textstyle(R^2 == .(round(err_rand[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_rand[[3]],2)))))))
dist_rand <- plot.knndm(rand_dist) +
geom_text(data=lab_rand,aes(x=x,y=y,label=lab),parse=T, colour="black")+
scale_x_continuous(limits=c(0,max(dist_knndm$data$r))) +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
legend_bottom <- get_legend(dist_rand +
guides(color = guide_legend(nrow = 1)) +
theme(legend.position = "bottom"))
top_row <- plot_grid(dist_rand,dist_knndm)
bp <- plot_grid(NULL, maps, NULL, sla_dens, NULL, nrow=5,
rel_heights = c(-0.3,1,-0.3,0.5,0))
ggsave("figures/6_sla_distances.png",bp, height=6, width=10)
sla_dens <- cowplot::plot_grid(top_row, NULL, legend_bottom, NULL, nrow=4,
rel_heights = c(1,-0.2,0.5,-0.1))
maps <- plot_grid(sla_map_rand, sla_map_knndm, nrow=1)
maps <- plot_grid(sla_map_rand, sla_map_knndm, nrow=1)
bp <- plot_grid(NULL, maps, NULL, sla_dens, NULL, nrow=5,
rel_heights = c(-0.3,1,-0.3,0.5,0))
ggsave("figures/6_sla_distances.png",bp, height=6, width=10)
top_row
top_row <- plot_grid(dist_rand,dist_knndm)
dist_rand
library("ggplot2")
library("cowplot")
library("rnaturalearth")
library("dplyr")
library("CAST")
source("code/figures_utils.R")
sla_kndm <- readRDS("results/sla_knndm.RDS")
rand_dist <- readRDS("rand_dist.RDS")
err_knndm <- readRDS("results/err_knndm.RDS")
err_rand <- readRDS("results/err_rand.RDS")
lab_knndm <- bquote(
atop(textstyle(RMSE == .(round(err_knndm[[1]],2))),
atop(textstyle(R^2 == .(round(err_knndm[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2)))))))
lab_rand <- bquote(
atop(textstyle(RMSE == .(round(err_rand[[1]],2))),
atop(textstyle(R^2 == .(round(err_rand[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_rand[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_rand <- plot.knndm(rand_dist) +
geom_text(data=lab_rand,aes(x=x,y=y,label=lab),parse=T, colour="black")+
scale_x_continuous(limits=c(0,max(dist_knndm$data$r))) +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
lab_rand
lab_knndm
plot.knndm(rand_dist)
plot.knndm(rand_dist)
plot.knndm(rand_dist) +
geom_text(data=lab_rand,aes(x=x,y=y,label=lab),parse=T, colour="black")
plot.knndm(sla_kndm) +
annotate(geom="text",x=12^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)
dist_rand <- plot.knndm(rand_dist) +
annotate(geom="text",x=12^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
scale_x_continuous(limits=c(0,max(dist_knndm$data$r))) +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
legend_bottom <- get_legend(dist_rand +
guides(color = guide_legend(nrow = 1)) +
theme(legend.position = "bottom"))
top_row <- plot_grid(dist_rand,dist_knndm)
top_row <- plot_grid(dist_rand,dist_knndm)
sla_dens <- cowplot::plot_grid(top_row, NULL, legend_bottom, NULL, nrow=4,
rel_heights = c(1,-0.2,0.5,-0.1))
ee <- st_crs("+proj=eqearth")
co <- ne_countries(returnclass = "sf")
co.ee <- st_transform(co, ee)
sla_map_rand <- ggplot() +
geom_sf(data=st_union(co.ee)) +
geom_sf(data=sla, size=0.2, color=sla_rand) +
theme_minimal()+
ggtitle("random 10-fold CV") +
theme(plot.title = element_text(face="bold", size = 14, hjust = 0.5))
sla_map_knndm <- ggplot() +
geom_sf(data=st_union(co.ee)) +
geom_sf(data=sla, size=0.2, color=sla_kndm$clusters) +
theme_minimal()+
ggtitle("kNNDM 4-fold CV") +
theme(plot.title = element_text(face="bold", size = 14, hjust = 0.5))
maps <- plot_grid(sla_map_rand, sla_map_knndm, nrow=1)
bp <- plot_grid(NULL, maps, NULL, sla_dens, NULL, nrow=5,
rel_heights = c(-0.3,1,-0.3,0.5,0))
ggsave("figures/6_sla_distances.png",bp, height=6, width=10)
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=11^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
library("ggplot2")
library("cowplot")
library("rnaturalearth")
library("dplyr")
library("CAST")
source("code/figures_utils.R")
sla_kndm <- readRDS("results/sla_knndm.RDS")
rand_dist <- readRDS("rand_dist.RDS")
err_knndm <- readRDS("results/err_knndm.RDS")
err_rand <- readRDS("results/err_rand.RDS")
lab_knndm <- bquote(
atop(textstyle(RMSE == .(round(err_knndm[[1]],2))),
atop(textstyle(R^2 == .(round(err_knndm[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2)))))))
lab_rand <- bquote(
atop(textstyle(RMSE == .(round(err_rand[[1]],2))),
atop(textstyle(R^2 == .(round(err_rand[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_rand[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=11^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_rand <- plot.knndm(rand_dist) +
annotate(geom="text",x=11^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
scale_x_continuous(limits=c(0,max(dist_knndm$data$r))) +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
legend_bottom <- get_legend(dist_rand +
guides(color = guide_legend(nrow = 1)) +
theme(legend.position = "bottom"))
top_row <- plot_grid(dist_rand,dist_knndm)
sla_dens <- cowplot::plot_grid(top_row, NULL, legend_bottom, NULL, nrow=4,
rel_heights = c(1,-0.2,0.5,-0.1))
ee <- st_crs("+proj=eqearth")
co <- ne_countries(returnclass = "sf")
co.ee <- st_transform(co, ee)
sla_map_rand <- ggplot() +
geom_sf(data=st_union(co.ee)) +
geom_sf(data=sla, size=0.2, color=sla_rand) +
theme_minimal()+
ggtitle("random 10-fold CV") +
theme(plot.title = element_text(face="bold", size = 14, hjust = 0.5))
sla_map_knndm <- ggplot() +
geom_sf(data=st_union(co.ee)) +
geom_sf(data=sla, size=0.2, color=sla_kndm$clusters) +
theme_minimal()+
ggtitle("kNNDM 4-fold CV") +
theme(plot.title = element_text(face="bold", size = 14, hjust = 0.5))
maps <- plot_grid(sla_map_rand, sla_map_knndm, nrow=1)
bp <- plot_grid(NULL, maps, NULL, sla_dens, NULL, nrow=5,
rel_heights = c(-0.3,1,-0.3,0.5,0))
ggsave("figures/6_sla_distances.png",bp, height=6, width=10)
library("ggplot2")
library("cowplot")
library("rnaturalearth")
library("dplyr")
library("CAST")
source("code/figures_utils.R")
sla_kndm <- readRDS("results/sla_knndm.RDS")
rand_dist <- readRDS("rand_dist.RDS")
err_knndm <- readRDS("results/err_knndm.RDS")
err_rand <- readRDS("results/err_rand.RDS")
lab_knndm <- bquote(
atop(textstyle(RMSE == .(round(err_knndm[[1]],2))),
atop(textstyle(R^2 == .(round(err_knndm[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2)))))))
lab_rand <- bquote(
atop(textstyle(RMSE == .(round(err_rand[[1]],2))),
atop(textstyle(R^2 == .(round(err_rand[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_rand[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=11.4^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_rand <- plot.knndm(rand_dist) +
annotate(geom="text",x=11.4^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
scale_x_continuous(limits=c(0,max(dist_knndm$data$r))) +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
legend_bottom <- get_legend(dist_rand +
guides(color = guide_legend(nrow = 1)) +
theme(legend.position = "bottom"))
top_row <- plot_grid(dist_rand,dist_knndm)
sla_dens <- cowplot::plot_grid(top_row, NULL, legend_bottom, NULL, nrow=4,
rel_heights = c(1,-0.2,0.5,-0.1))
ee <- st_crs("+proj=eqearth")
co <- ne_countries(returnclass = "sf")
co.ee <- st_transform(co, ee)
sla_map_rand <- ggplot() +
geom_sf(data=st_union(co.ee)) +
geom_sf(data=sla, size=0.2, color=sla_rand) +
theme_minimal()+
ggtitle("random 10-fold CV") +
theme(plot.title = element_text(face="bold", size = 14, hjust = 0.5))
sla_map_knndm <- ggplot() +
geom_sf(data=st_union(co.ee)) +
geom_sf(data=sla, size=0.2, color=sla_kndm$clusters) +
theme_minimal()+
ggtitle("kNNDM 4-fold CV") +
theme(plot.title = element_text(face="bold", size = 14, hjust = 0.5))
maps <- plot_grid(sla_map_rand, sla_map_knndm, nrow=1)
bp <- plot_grid(NULL, maps, NULL, sla_dens, NULL, nrow=5,
rel_heights = c(-0.3,1,-0.3,0.5,0))
ggsave("figures/6_sla_distances.png",bp, height=6, width=10)
lab_knndm
lab_rand
library("ggplot2")
library("cowplot")
library("rnaturalearth")
library("dplyr")
library("CAST")
source("code/figures_utils.R")
sla_kndm <- readRDS("results/sla_knndm.RDS")
rand_dist <- readRDS("rand_dist.RDS")
err_knndm <- readRDS("results/err_knndm.RDS")
err_rand <- readRDS("results/err_rand.RDS")
lab_knndm <- bquote(
atop(textstyle(RMSE == .(round(err_knndm[[1]],2))),
atop(textstyle(R^2 == .(round(err_knndm[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_knndm[[3]],2)))))))
lab_rand <- bquote(
atop(textstyle(RMSE == .(round(err_rand[[1]],2))),
atop(textstyle(R^2 == .(round(err_rand[[2]],2))),
atop(scriptscriptstyle(""),textstyle(MAE == .(round(err_rand[[3]],2)))))))
dist_knndm <- plot.knndm(sla_kndm) +
annotate(geom="text",x=11.4^6,y=0.4, label=lab_knndm, colour="black",hjust = 0, size=4)+
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
dist_rand <- plot.knndm(rand_dist) +
annotate(geom="text",x=11.4^6,y=0.4, label=lab_rand, colour="black",hjust = 0, size=4)+
scale_x_continuous(limits=c(0,max(dist_knndm$data$r))) +
theme_bw() +
theme(legend.position = NaN, aspect.ratio = 1)
legend_bottom <- get_legend(dist_rand +
guides(color = guide_legend(nrow = 1)) +
theme(legend.position = "bottom"))
top_row <- plot_grid(dist_rand,dist_knndm)
sla_dens <- cowplot::plot_grid(top_row, NULL, legend_bottom, NULL, nrow=4,
rel_heights = c(1,-0.2,0.5,-0.1))
ee <- st_crs("+proj=eqearth")
co <- ne_countries(returnclass = "sf")
co.ee <- st_transform(co, ee)
sla_map_rand <- ggplot() +
geom_sf(data=st_union(co.ee)) +
geom_sf(data=sla, size=0.2, color=sla_rand) +
theme_minimal()+
ggtitle("random 10-fold CV") +
theme(plot.title = element_text(face="bold", size = 14, hjust = 0.5))
sla_map_knndm <- ggplot() +
geom_sf(data=st_union(co.ee)) +
geom_sf(data=sla, size=0.2, color=sla_kndm$clusters) +
theme_minimal()+
ggtitle("kNNDM 4-fold CV") +
theme(plot.title = element_text(face="bold", size = 14, hjust = 0.5))
maps <- plot_grid(sla_map_rand, sla_map_knndm, nrow=1)
bp <- plot_grid(NULL, maps, NULL, sla_dens, NULL, nrow=5,
rel_heights = c(-0.3,1,-0.3,0.5,0))
ggsave("figures/6_sla_distances.png",bp, height=6, width=10)
print(sla_kndm$W)
print(rand_dist$W)
