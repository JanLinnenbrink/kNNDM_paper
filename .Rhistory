set.seed(100)
ppoints <- st_sample(AOI, 500, type = "regular") |>
st_transform(st_crs(tpoints_rand))
set.seed(100)
k_reg <- knndm(tpoints_reg, ppoints=ppoints)
set.seed(100)
k_rand <- knndm(tpoints_rand, ppoints=ppoints)
set.seed(100)
k_clust <- knndm(tpoints_cl, k = 2,  ppoints=ppoints, maxp=0.8)
pts.size <- 1
ppts.alpha <- 0.5
base.size <- 12
Ws <- lapply(list(k_reg, k_rand,k_clust), function(x) twosamples::wass_stat(x$Gj, x$Gij))
reg_dist <- plot.knndm.integral(k_reg) +
scale_x_continuous(labels = function(x) format(x, scientific = TRUE),n.breaks = 3, limits=c(0,4*10^5)) +
geom_text(aes(label=paste("W=", round(Ws[[1]])), x=12^5,y=0.6), size=5, col="orange") +
xlab("r") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = NaN,plot.margin = unit(rep(0.2,4), "cm"))
rand_dist <- plot.knndm.integral(k_rand) +
scale_x_continuous(labels = function(x) format(x, scientific = TRUE),n.breaks = 3, limits=c(0,4*10^5)) +
geom_text(aes(label=paste("W=", round(Ws[[2]])), x=12^5,y=0.6), size=5, col="orange") +
xlab("r") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = NaN,plot.margin = unit(rep(0.2,4), "cm"))
clust_dist <- plot.knndm.integral(k_clust) +
scale_x_continuous(labels = function(x) format(x, scientific = TRUE),n.breaks = 3, limits=c(0,4*10^5)) +
xlab("r") +
geom_text(aes(label=paste("W=", round(Ws[[3]])), x=12^5,y=0.6), size=5, col="orange") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = NaN,plot.margin = unit(rep(0.2,4), "cm"))
legend_bottom <- get_legend(rand_dist+
guides(color = guide_legend(nrow = 1)) +
theme(legend.position = "bottom"))
pts_cl_pl <- ggplot() +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=ppoints, size=0.2, alpha=ppts.alpha) +
geom_sf(data=tpoints_cl,size=pts.size) +
scale_color_manual(values = c("blue","orange")) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw(base_size = base.size) +
theme(legend.position = "None",
strip.text.x = element_text(size = 12),
plot.margin = unit(rep(0.2,4), "cm")) +
facet_wrap(~cl)
pts_reg_pl <- ggplot() +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=ppoints, size=0.2, alpha=ppts.alpha) +
geom_sf(data=tpoints_reg, size=pts.size) +
scale_color_manual(values= rainbow(10)) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw(base_size = base.size) +
theme(legend.position = "None",
strip.text.x = element_text(size = 12),
plot.margin = unit(rep(0.2,4), "cm")) +
facet_wrap(~cl)
pts_rand_pl <- ggplot() +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=ppoints, size=0.2, alpha=ppts.alpha) +
geom_sf(data=tpoints_rand, size=pts.size) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw(base_size = base.size) +
theme(legend.position = "None",
strip.text.x = element_text(size = 12),
plot.margin = unit(rep(0.2,4), "cm")) +
facet_wrap(~cl)
top_row <- plot_grid(pts_reg_pl, pts_rand_pl, pts_cl_pl, nrow=1)
bottom_row <- plot_grid(reg_dist, rand_dist,  clust_dist, nrow=1)
comb_pl <- plot_grid(NULL, top_row, NULL, bottom_row, NULL, legend_bottom, NULL,
nrow=7, rel_heights = c(-0.22,1, -0.42,1,-0.7,1,-0.45))
ggsave("figures/1_example_ecdfs.png", comb_pl, height = 12, width=20, units="cm")
comb_pl
library("ggplot2")
library("sf")
library("CAST")
library("cowplot")
source("code/figures_utils.R")
wgrid <- st_read(dsn="data/species_vdata.gpkg", layer="landscape_grid")
AOI <- st_read(dsn="data/species_vdata.gpkg", layer="sampling_polygon") |>
st_transform(st_crs(wgrid))
set.seed(10)
tpoints <-  sim2_samples(100, "sclust", AOI)
set.seed(10)
ppoints <- st_sample(AOI, 1000, type = "regular")
tpoints <- st_transform(tpoints, st_crs(ppoints))
AOI <- st_transform(AOI, st_crs(ppoints))
k <- 2
maxp <- 0.8
set.seed(10)
k_out <- k_plot(k, maxp, tpoints, ppoints)
pts_cl <- st_sf(do.call("cbind.data.frame",k_out[[1]]), geom=st_geometry(tpoints))
W <- k_out[[2]]$W
Gjstar_i <- k_out[[3]]
Gij <- k_out[[4]]
Gj <- k_out[[5]]
df <- lapply(Gjstar_i, function(x) list(x,Gij,Gj))
df <- lapply(df, function(x) {names(x) <- c("Gjstar","Gij","Gj");return(x)})
dist_plts <- mapply(function(x,y){
plot.knndm(x) +
ggtitle(paste0("W=", round(y))) +
scale_x_continuous(limits=c(0,4*10^5), n.breaks = 3) +
ylab("") +
theme_bw() +
theme(aspect.ratio = 1,
legend.position = NaN,
title=element_text(size=9))
}, x=df, y=W, SIMPLIFY = FALSE)
dst_pl <- plot_grid(plotlist = dist_plts, nrow = 1)
pts_list <- apply(st_drop_geometry(pts_cl), 2, function(x) x, simplify = FALSE)
pts_list_geo <- lapply(pts_list, function(x) st_sf(x, geom=pts_cl$geom))
pt.size <- 0.8
title_p <- k_out[[6]]
point_pl <- mapply(function(x,y) {
ggplot() +
ggtitle(paste0("q=", y)) +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=x, aes(col = as.factor(x[[1]])), size=pt.size)+
scale_color_manual(values=c("blue", "red")) +
scale_shape_manual(values=rep(16, length(unique(x[[1]])))) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw()+
theme(legend.position = NaN,
title = element_text(size=9))
}, x=pts_list_geo,y=title_p, SIMPLIFY = FALSE)
pts_pl <- plot_grid(plotlist = point_pl, nrow=1)
bottom_row <- plot_grid(dst_pl)
top_row <- plot_grid(pts_pl)
legend_bottom <- get_legend(dist_plts[[1]] +
guides(color = guide_legend(nrow = 1)) +
theme(legend.position = "bottom"))
c <- plot_grid(NULL,top_row, NULL, bottom_row, NULL, legend_bottom, nrow=6,rel_heights = c(-0.25,1,-0.35,1,-0.2,0.2))
#ggsave("figures/2_method_knndm.pdf",c, height=5, width=12)
c
ggsave("figures/2_method_knndm.pdf",c, height=5, width=12)
library("ggplot2")
library("sf")
library("CAST")
library("cowplot")
source("code/figures_utils.R")
source("code/sim_functions.R")
AOI <- st_read(dsn="data/species_vdata.gpkg", layer="sampling_polygon")
AOI_part <- st_buffer(AOI, -200000)
set.seed(10)
tpoints_rand <- sim2_samples(100, "random", AOI)
set.seed(10)
tpoints_reg <- sim2_samples(100, "sregular", AOI)
set.seed(10)
tpoints_cl <-  sim2_samples(100, "sclust", AOI)
tpoints_cl$cl <- "clustered"
tpoints_rand$cl <- "random"
tpoints_reg$cl <- "regular"
tp <- rbind(tpoints_rand, tpoints_cl)
set.seed(100)
ppoints <- st_sample(AOI, 500, type = "regular") |>
st_transform(st_crs(tpoints_rand))
set.seed(100)
k_reg <- knndm(tpoints_reg, ppoints=ppoints)
set.seed(100)
k_rand <- knndm(tpoints_rand, ppoints=ppoints)
set.seed(100)
k_clust <- knndm(tpoints_cl, k = 2,  ppoints=ppoints, maxp=0.8)
pts.size <- 1
ppts.alpha <- 0.5
base.size <- 12
Ws <- lapply(list(k_reg, k_rand,k_clust), function(x) twosamples::wass_stat(x$Gj, x$Gij))
reg_dist <- plot.knndm.integral(k_reg) +
scale_x_continuous(labels = function(x) format(x, scientific = TRUE),n.breaks = 3, limits=c(0,4*10^5)) +
geom_text(aes(label=paste("W=", round(Ws[[1]])), x=12^5,y=0.6), size=5, col="orange") +
xlab("r") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = NaN,plot.margin = unit(rep(0.2,4), "cm"))
rand_dist <- plot.knndm.integral(k_rand) +
scale_x_continuous(labels = function(x) format(x, scientific = TRUE),n.breaks = 3, limits=c(0,4*10^5)) +
geom_text(aes(label=paste("W=", round(Ws[[2]])), x=12^5,y=0.6), size=5, col="orange") +
xlab("r") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = NaN,plot.margin = unit(rep(0.2,4), "cm"))
clust_dist <- plot.knndm.integral(k_clust) +
scale_x_continuous(labels = function(x) format(x, scientific = TRUE),n.breaks = 3, limits=c(0,4*10^5)) +
xlab("r") +
geom_text(aes(label=paste("W=", round(Ws[[3]])), x=12^5,y=0.6), size=5, col="orange") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = NaN,plot.margin = unit(rep(0.2,4), "cm"))
legend_bottom <- get_legend(rand_dist+
guides(color = guide_legend(nrow = 1)) +
theme(legend.position = "bottom"))
pts_cl_pl <- ggplot() +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=ppoints, size=0.2, alpha=ppts.alpha) +
geom_sf(data=tpoints_cl,size=pts.size) +
scale_color_manual(values = c("blue","orange")) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw(base_size = base.size) +
theme(legend.position = "None",
strip.text.x = element_text(size = 12),
plot.margin = unit(rep(0.2,4), "cm")) +
facet_wrap(~cl)
pts_reg_pl <- ggplot() +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=ppoints, size=0.2, alpha=ppts.alpha) +
geom_sf(data=tpoints_reg, size=pts.size) +
scale_color_manual(values= rainbow(10)) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw(base_size = base.size) +
theme(legend.position = "None",
strip.text.x = element_text(size = 12),
plot.margin = unit(rep(0.2,4), "cm")) +
facet_wrap(~cl)
pts_rand_pl <- ggplot() +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=ppoints, size=0.2, alpha=ppts.alpha) +
geom_sf(data=tpoints_rand, size=pts.size) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw(base_size = base.size) +
theme(legend.position = "None",
strip.text.x = element_text(size = 12),
plot.margin = unit(rep(0.2,4), "cm")) +
facet_wrap(~cl)
top_row <- plot_grid(pts_reg_pl, pts_rand_pl, pts_cl_pl, nrow=1)
bottom_row <- plot_grid(reg_dist, rand_dist,  clust_dist, nrow=1)
comb_pl <- plot_grid(NULL, top_row, NULL, bottom_row, NULL, legend_bottom, NULL,
nrow=7, rel_heights = c(-0.22,1, -0.42,1,-0.7,1,-0.45))
#ggsave("figures/1_example_ecdfs.png", comb_pl, height = 12, width=20, units="cm")
comb_pl
ggsave("figures/1_example_ecdfs.png", comb_pl, height = 12, width=20, units="cm")
library("ggplot2")
library("cowplot")
cor_res <- read.csv("results/sim_res_W.csv")
cor_diff <- data.frame(rmse_diff = cor_res$RMSE_kndm - cor_res$RMSE_surf,
r2_diff = cor_res$R2_kndm - cor_res$R2_surf,
mae_diff = cor_res$MAE_kndm - cor_res$MAE_surf,
ws = cor_res$WS,
dsample = cor_res$dsample)
m <- 0.5
b.size <- 20
lm_rmse <- lm(abs(rmse_diff)~ws, cor_diff)
r2_rmse <- round(summary(lm_rmse)$r.squared,2)
pred_rmse <- predict(lm_rmse, cor_diff)
lm_mae <- lm(abs(mae_diff)~ws, cor_diff)
r2_mae <- round(summary(lm_mae)$r.squared,2)
pred_mae <- predict(lm_mae, cor_diff)
lm_r2 <- lm(abs(r2_diff)~ws, cor_diff)
r2_r2 <- round(summary(lm_r2)$r.squared,2)
pred_r2 <- predict(lm_r2, cor_diff)
print(paste("Rsquared for Rsquared:", r2_r2, ";",
"Rsquared for MAE:", r2_mae, ";",
"Rsquared for RMSE:", r2_rmse))
rmse <- ggplot(data=cor_diff, aes(x=ws,y=abs(rmse_diff))) +
geom_bin_2d(bins=30) +
geom_line(aes(y=pred_rmse), col="black", linewidth=1.2) +
scale_fill_viridis_b(trans="log10") +
scale_x_continuous(n.breaks = 3,labels = function(x) format(x, scientific = FALSE)) +
ylab(expression(abs(CV - true~RMSE))) +
xlab("W") +
theme_bw(base_size=b.size) +
theme(aspect.ratio=1, legend.position = NaN,
plot.margin = unit(unit(rep(m,4), "cm")))
mae <- ggplot(data=cor_diff, aes(x=ws,y=abs(mae_diff))) +
geom_bin_2d(bins=30) +
geom_line(aes(y=pred_mae), col="black", linewidth=1.2) +
scale_fill_viridis_b(trans="log10") +
scale_x_continuous(n.breaks = 3,labels = function(x) format(x, scientific = FALSE)) +
ylab(expression(abs(CV - true~MAE))) +
xlab("W") +
theme_bw(base_size=b.size) +
theme(aspect.ratio=1, legend.position = NaN,
plot.margin = unit(rep(m,4), "cm"))
r2 <- ggplot(data=cor_diff, aes(x=ws,y=abs(r2_diff))) +
geom_bin_2d(bins=30) +
geom_line(aes(y=pred_r2), col="black", linewidth=1.2) +
scale_fill_viridis_b(trans="log10") +
scale_x_continuous(n.breaks = 3,labels = function(x) format(x, scientific = FALSE)) +
ylab(expression(abs(CV - true~R^2))) +
xlab("W") +
theme_bw(base_size=b.size) +
theme(aspect.ratio=1, legend.position = NaN,
plot.margin = unit(unit(rep(m,4), "cm")))
legend_bottom <- get_legend(rmse +
guides(color = guide_legend(nrow = 1)) +
theme(legend.position = "bottom",
legend.key.width  = unit(1.5, "cm"),
legend.key.height  = unit(0.5, "cm"),
plot.margin = unit(c(0, 0, 0, 0), "cm")))
top_row <- plot_grid(rmse, r2, mae, nrow=1, align="hv")
c <- plot_grid(top_row, NULL, legend_bottom, NULL, nrow=4,
rel_heights = c(1,-0.35,1,-0.4), rel_widths = c(1,1,5,1))
#ggsave("figures/4_results_W_err.pdf",c, height=5, width=12)
c
library("ggplot2")
library("sf")
library("CAST")
library("cowplot")
source("code/figures_utils.R")
source("code/sim_functions.R")
AOI <- st_read(dsn="data/species_vdata.gpkg", layer="sampling_polygon")
AOI_part <- st_buffer(AOI, -200000)
set.seed(10)
tpoints_rand <- sim2_samples(100, "random", AOI)
set.seed(10)
tpoints_reg <- sim2_samples(100, "sregular", AOI)
set.seed(10)
tpoints_cl <-  sim2_samples(100, "sclust", AOI)
tpoints_cl$cl <- "clustered"
tpoints_rand$cl <- "random"
tpoints_reg$cl <- "regular"
tp <- rbind(tpoints_rand, tpoints_cl)
set.seed(100)
ppoints <- st_sample(AOI, 500, type = "regular") |>
st_transform(st_crs(tpoints_rand))
set.seed(100)
k_reg <- knndm(tpoints_reg, ppoints=ppoints)
set.seed(100)
k_rand <- knndm(tpoints_rand, ppoints=ppoints)
set.seed(100)
k_clust <- knndm(tpoints_cl, k = 2,  ppoints=ppoints, maxp=0.8)
pts.size <- 1
ppts.alpha <- 0.5
base.size <- 12
Ws <- lapply(list(k_reg, k_rand,k_clust), function(x) twosamples::wass_stat(x$Gj, x$Gij))
reg_dist <- plot.knndm.integral(k_reg) +
scale_x_continuous(labels = function(x) format(x, scientific = TRUE),n.breaks = 3, limits=c(0,4*10^5)) +
geom_text(aes(label=paste("W=", round(Ws[[1]])), x=12^5,y=0.6), size=5, col="orange") +
xlab("r") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = NaN,plot.margin = unit(rep(0.2,4), "cm"))
rand_dist <- plot.knndm.integral(k_rand) +
scale_x_continuous(labels = function(x) format(x, scientific = TRUE),n.breaks = 3, limits=c(0,4*10^5)) +
geom_text(aes(label=paste("W=", round(Ws[[2]])), x=12^5,y=0.6), size=5, col="orange") +
xlab("r") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = NaN,plot.margin = unit(rep(0.2,4), "cm"))
clust_dist <- plot.knndm.integral(k_clust) +
scale_x_continuous(labels = function(x) format(x, scientific = TRUE),n.breaks = 3, limits=c(0,4*10^5)) +
xlab("r") +
geom_text(aes(label=paste("W=", round(Ws[[3]])), x=12^5,y=0.6), size=5, col="orange") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = NaN,plot.margin = unit(rep(0.2,4), "cm"))
legend_bottom <- get_legend(rand_dist+
guides(color = guide_legend(nrow = 1)) +
theme(legend.position = "bottom"))
pts_cl_pl <- ggplot() +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=ppoints, size=0.2, alpha=ppts.alpha) +
geom_sf(data=tpoints_cl,size=pts.size) +
scale_color_manual(values = c("blue","orange")) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw(base_size = base.size) +
theme(legend.position = "None",
strip.text.x = element_text(size = 12),
plot.margin = unit(rep(0.2,4), "cm")) +
facet_wrap(~cl)
pts_reg_pl <- ggplot() +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=ppoints, size=0.2, alpha=ppts.alpha) +
geom_sf(data=tpoints_reg, size=pts.size) +
scale_color_manual(values= rainbow(10)) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw(base_size = base.size) +
theme(legend.position = "None",
strip.text.x = element_text(size = 12),
plot.margin = unit(rep(0.2,4), "cm")) +
facet_wrap(~cl)
pts_rand_pl <- ggplot() +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=ppoints, size=0.2, alpha=ppts.alpha) +
geom_sf(data=tpoints_rand, size=pts.size) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw(base_size = base.size) +
theme(legend.position = "None",
strip.text.x = element_text(size = 12),
plot.margin = unit(rep(0.2,4), "cm")) +
facet_wrap(~cl)
top_row <- plot_grid(pts_reg_pl, pts_rand_pl, pts_cl_pl, nrow=1)
bottom_row <- plot_grid(reg_dist, rand_dist,  clust_dist, nrow=1)
comb_pl <- plot_grid(NULL, top_row, NULL, bottom_row, NULL, legend_bottom, NULL,
nrow=7, rel_heights = c(-0.22,1, -0.42,1,-0.7,1,-0.45))
#ggsave("figures/1_example_ecdfs.png", comb_pl, height = 12, width=20, units="cm")
comb_pl
AOI <- (st_read(dsn="data/species_vdata.gpkg", layer="sampling_polygon"))
AOI <- suppressMessages(st_read(dsn="data/species_vdata.gpkg", layer="sampling_polygon"))
AOI <- invisible(st_read(dsn="data/species_vdata.gpkg", layer="sampling_polygon"))
invisible(st_read(dsn="data/species_vdata.gpkg", layer="sampling_polygon"))
AOI <- capture.output(st_read(dsn="data/species_vdata.gpkg", layer="sampling_polygon"))
AOI
capture.output(st_read(dsn="data/species_vdata.gpkg", layer="sampling_polygon"))
plot(AOI)
AOI <- quiet(st_read(dsn="data/species_vdata.gpkg", layer="sampling_polygon"))
AOI
?quiet
wgrid <- quiet(st_read(dsn="data/species_vdata.gpkg", layer="landscape_grid"))
AOI <- quiet(st_read(dsn="data/species_vdata.gpkg", layer="sampling_polygon")) |>
st_transform(st_crs(wgrid))
library("ggplot2")
library("sf")
library("CAST")
library("cowplot")
source("code/figures_utils.R")
source("code/sim_functions.R")
AOI <- quiet(st_read(dsn="data/species_vdata.gpkg", layer="sampling_polygon"))
AOI_part <- st_buffer(AOI, -200000)
set.seed(1)
tpoints_rand <- sim2_samples(100, "random", AOI)
set.seed(1)
tpoints_reg <- sim2_samples(100, "sregular", AOI)
set.seed(1)
tpoints_cl <-  sim2_samples(100, "sclust", AOI)
tpoints_cl$cl <- "clustered"
tpoints_rand$cl <- "random"
tpoints_reg$cl <- "regular"
tp <- rbind(tpoints_rand, tpoints_cl)
set.seed(100)
ppoints <- st_sample(AOI, 500, type = "regular") |>
st_transform(st_crs(tpoints_rand))
set.seed(100)
k_reg <- knndm(tpoints_reg, ppoints=ppoints)
set.seed(100)
k_rand <- knndm(tpoints_rand, ppoints=ppoints)
set.seed(100)
k_clust <- knndm(tpoints_cl, k = 2,  ppoints=ppoints, maxp=0.8)
pts.size <- 1
ppts.alpha <- 0.5
base.size <- 12
Ws <- lapply(list(k_reg, k_rand,k_clust), function(x) twosamples::wass_stat(x$Gj, x$Gij))
reg_dist <- plot.knndm.integral(k_reg) +
scale_x_continuous(labels = function(x) format(x, scientific = TRUE),n.breaks = 3, limits=c(0,4*10^5)) +
geom_text(aes(label=paste("W=", round(Ws[[1]])), x=12^5,y=0.6), size=5, col="orange") +
xlab("r") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = NaN,plot.margin = unit(rep(0.2,4), "cm"))
rand_dist <- plot.knndm.integral(k_rand) +
scale_x_continuous(labels = function(x) format(x, scientific = TRUE),n.breaks = 3, limits=c(0,4*10^5)) +
geom_text(aes(label=paste("W=", round(Ws[[2]])), x=12^5,y=0.6), size=5, col="orange") +
xlab("r") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = NaN,plot.margin = unit(rep(0.2,4), "cm"))
clust_dist <- plot.knndm.integral(k_clust) +
scale_x_continuous(labels = function(x) format(x, scientific = TRUE),n.breaks = 3, limits=c(0,4*10^5)) +
xlab("r") +
geom_text(aes(label=paste("W=", round(Ws[[3]])), x=12^5,y=0.6), size=5, col="orange") +
theme_bw(base_size = base.size) +
theme(aspect.ratio = 1, legend.position = NaN,plot.margin = unit(rep(0.2,4), "cm"))
legend_bottom <- get_legend(rand_dist+
guides(color = guide_legend(nrow = 1)) +
theme(legend.position = "bottom"))
pts_cl_pl <- ggplot() +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=ppoints, size=0.2, alpha=ppts.alpha) +
geom_sf(data=tpoints_cl,size=pts.size) +
scale_color_manual(values = c("blue","orange")) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw(base_size = base.size) +
theme(legend.position = "None",
strip.text.x = element_text(size = 12),
plot.margin = unit(rep(0.2,4), "cm")) +
facet_wrap(~cl)
pts_reg_pl <- ggplot() +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=ppoints, size=0.2, alpha=ppts.alpha) +
geom_sf(data=tpoints_reg, size=pts.size) +
scale_color_manual(values= rainbow(10)) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw(base_size = base.size) +
theme(legend.position = "None",
strip.text.x = element_text(size = 12),
plot.margin = unit(rep(0.2,4), "cm")) +
facet_wrap(~cl)
pts_rand_pl <- ggplot() +
geom_sf(data=AOI, alpha=0) +
geom_sf(data=ppoints, size=0.2, alpha=ppts.alpha) +
geom_sf(data=tpoints_rand, size=pts.size) +
scale_x_continuous(breaks=c(-8,0)) +
scale_y_continuous(breaks=c(38,42)) +
theme_bw(base_size = base.size) +
theme(legend.position = "None",
strip.text.x = element_text(size = 12),
plot.margin = unit(rep(0.2,4), "cm")) +
facet_wrap(~cl)
top_row <- plot_grid(pts_reg_pl, pts_rand_pl, pts_cl_pl, nrow=1)
bottom_row <- plot_grid(reg_dist, rand_dist,  clust_dist, nrow=1)
comb_pl <- plot_grid(NULL, top_row, NULL, bottom_row, NULL, legend_bottom, NULL,
nrow=7, rel_heights = c(-0.22,1, -0.42,1,-0.7,1,-0.45))
#ggsave("figures/1_example_ecdfs.png", comb_pl, height = 12, width=20, units="cm")
comb_pl
set.seed(20)
tpoints_rand <- sim2_samples(100, "random", AOI)
tpoints_rand <- sim2_samples(100, "random", AOI)
set.seed(20)
tpoints_reg <- sim2_samples(100, "sregular", AOI)
tpoints_rand <- sim2_samples(100, "random", AOI)
set.seed(20)
tpoints_reg <- sim2_samples(100, "sregular", AOI)
set.seed(20)
set.seed(20)
tpoints_cl <-  sim2_samples(100, "sclust", AOI)
plot(tpoints_cl)
plot(tpoints_cl)
set.seed(15)
tpoints_cl <-  sim2_samples(100, "sclust", AOI)
plot(tpoints_cl)
citation()
